<script lang="ts">

  import axios from "../axios.config";
  import { push } from "svelte-spa-router";
  import { logged } from "../stores";
  import { toast } from '@zerodevx/svelte-toast/dist'

  let code: number = null

  function success2FA() {
    code = null
    toast.push('Welcome! ðŸ‘‹', { classes: ['success'] })
    logged.set('true')
    push('/')
  }

  function failure2FA() {
    code = null
    toast.push('Error', { classes: ['failure'] })
    logged.set('false')
  }

  async function validate2FA() {
    try {
      const response = await axios.post('/auth/2FA/login', { token: code })
      return response.data === true ? success2FA() : failure2FA()
    } catch (e) {
      console.log(e)
    }
  }

</script>

<br>
<br>
<br>

<input type="text" inputmode="numeric" bind:value={code}>
<button on:click={validate2FA}>2FA Validate</button>